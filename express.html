<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Node Express</title>
</head>
<body>
	<section>
		<h2>FORM表单格式</h2>
		<form action="http://localhost:8081/formsubmit" method="GET" enctype="text/plain">
			First Name: <input type="text" name="first_name">
			<br>
			Last Name: <input type="text" name="last_name">
			<br>
			Submit: <input type="submit" value="Submit">
		</form>
		<br>
		<button id="jsSubmit">js发送</button>
	</section>

	<section>
		<h2>POST</h2>
		<button id="submit">jQuery发送</button>
	</section>

	<script src="http://apps.bdimg.com/libs/jquery/1.6.4/jquery.min.js"></script>
	<script>
		var jsSubmitBtn = document.getElementById('jsSubmit');
		jsSubmitBtn.onclick = function() {
			var postBody = {
				value: 1
			};
			var xhr = new XMLHttpRequest();
			xhr.onreadystatechange = function() {
				if (xhr.readyState == 4) {
					if (xhr.status >= 200 && xhr.status < 300 || xhr.status == 304) {
						console.log(xhr.responseText);
					} else {
						console.log('unsuccessful:' + xhr.status);
					}
				}
			};
			xhr.open('get', "http://localhost:8081/formsubmit?first_name=hongyan&last_name=fang", true);
			// xhr.setRequestHeader('Content-Type', 'application/x-www-form-urllencoded');
			xhr.send(null);
		}

		$(document).ready(function() {
			// 点击jQuery发送
			$('#submit').click(function() {
				var postBody = {
					value: 1
				};
				httpMethod('http://localhost:8081/postTest', 'post', postBody).then(function(data) {
					console.log('jQuery', data);
				}, function(data) {
					console.log('jQuery', data);
				})
				
			});

			function httpMethod(url, method, dataObj) {
				var defer = $.Deferred();
				$.ajax({
					url: url,
					type: method,
					dataType: 'json',
					data: JSON.stringify(dataObj), // important
					contentType:'application/json; charset=utf-8', // important
					success : function(data){
						defer.resolve(data);//执行状态从"未完成"改为"已完成"
					},
					error : function(data){
						defer.reject(data);
					}
				})
				return defer.promise();
			}
		});
	</script>
</body>
</html>